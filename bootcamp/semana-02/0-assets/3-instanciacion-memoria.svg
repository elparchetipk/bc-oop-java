<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 700">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; fill: #e0e0e0; }
      .subtitle { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #b0b0b0; }
      .text { font-family: Arial, sans-serif; font-size: 14px; fill: #e0e0e0; }
      .small-text { font-family: Arial, sans-serif; font-size: 12px; fill: #9e9e9e; }
      .code { font-family: 'Courier New', monospace; font-size: 13px; fill: #e0e0e0; }
      .code-highlight { font-family: 'Courier New', monospace; font-size: 13px; fill: #f87171; font-weight: bold; }
      .memory-box { fill: #1e1e1e; stroke: #4a5568; stroke-width: 2; }
      .stack-area { fill: #1e293b; }
      .heap-area { fill: #164e63; }
      .reference-arrow { fill: none; stroke: #e67e22; stroke-width: 2.5; }
      .step-box { fill: #2563eb; opacity: 0.9; }
      .step-text { font-family: Arial, sans-serif; font-size: 12px; fill: white; font-weight: bold; }
      .bg-dark { fill: #121212; }
      .box-dark { fill: #1a202c; }
    </style>
    <marker id="arrow-ref" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#e67e22"/>
    </marker>
  </defs>

  <!-- Fondo oscuro -->
  <rect width="900" height="700" class="bg-dark"/>

  <!-- Título -->
  <text x="450" y="40" text-anchor="middle" class="title">Proceso de Instanciación en Memoria</text>
  <text x="450" y="65" text-anchor="middle" class="small-text">¿Qué sucede cuando creamos un objeto con "new"?</text>

  <!-- PASO 1: CÓDIGO -->
  <g id="codigo">
    <rect x="50" y="100" width="380" height="120" rx="8" class="box-dark" stroke="#3498db" stroke-width="2"/>

    <circle cx="70" cy="115" r="18" class="step-box"/>
    <text x="70" y="122" text-anchor="middle" class="step-text">1</text>

    <text x="100" y="125" class="subtitle">Código Java</text>

    <text x="70" y="155" class="code">Persona p1 = new Persona("Juan", 25);</text>
    <text x="70" y="175" class="code">│ │</text>
    <text x="70" y="195" class="code-highlight">referencia operador new</text>
  </g>

  <!-- PASO 2: MEMORIA -->
  <g id="memoria">
    <circle cx="470" cy="115" r="18" class="step-box"/>
    <text x="470" y="122" text-anchor="middle" class="step-text">2</text>

    <text x="500" y="125" class="subtitle">Organización de Memoria</text>

    <!-- Contenedor de memoria -->
    <rect x="470" y="140" width="380" height="480" rx="10" class="memory-box"/>

    <!-- STACK (Pila) -->
    <rect x="490" y="160" width="160" height="440" class="stack-area" stroke="#5c6bc0" stroke-width="2"/>
    <text x="570" y="185" text-anchor="middle" class="subtitle" fill="#93c5fd">STACK</text>
    <text x="570" y="205" text-anchor="middle" class="small-text">(Pila)</text>

    <!-- Variables locales en stack -->
    <rect x="505" y="225" width="130" height="50" fill="#334155" stroke="#5c6bc0" stroke-width="2" rx="5"/>
    <text x="570" y="245" text-anchor="middle" class="text" font-weight="bold">Variable: p1</text>
    <text x="570" y="265" text-anchor="middle" class="small-text">Tipo: Persona</text>

    <!-- Valor de referencia -->
    <rect x="505" y="285" width="130" height="40" fill="#422006" stroke="#e67e22" stroke-width="2" rx="5"/>
    <text x="570" y="305" text-anchor="middle" class="code-highlight">@0x1A2B3C</text>
    <text x="570" y="320" text-anchor="middle" class="small-text" style="fill:#fb923c;">dirección</text>

    <text x="570" y="345" class="small-text">↓ Almacena:</text>
    <text x="570" y="360" class="small-text">• Referencias</text>
    <text x="570" y="375" class="small-text">• Variables locales</text>
    <text x="570" y="390" class="small-text">• Tipos primitivos</text>

    <!-- HEAP (Montículo) -->
    <rect x="660" y="160" width="170" height="440" class="heap-area" stroke="#14b8a6" stroke-width="2"/>
    <text x="745" y="185" text-anchor="middle" class="subtitle" fill="#5eead4">HEAP</text>
    <text x="745" y="205" text-anchor="middle" class="small-text">(Montículo)</text>

    <!-- Objeto en heap -->
    <rect x="675" y="225" width="140" height="140" fill="#334155" stroke="#10b981" stroke-width="3" rx="5"/>
    <text x="745" y="245" text-anchor="middle" class="text" font-weight="bold">Objeto Persona</text>
    <text x="745" y="265" text-anchor="middle" class="small-text" style="fill:#fb923c;">@0x1A2B3C</text>

    <line x1="680" y1="275" x2="810" y2="275" stroke="#4a5568"/>

    <text x="685" y="295" class="code">nombre: "Juan"</text>
    <text x="685" y="315" class="code">edad: 25</text>
    <text x="685" y="335" class="code">altura: 0.0</text>
    <text x="685" y="355" class="code">email: null</text>

    <text x="745" y="385" class="small-text">↓ Almacena:</text>
    <text x="745" y="400" class="small-text">• Objetos</text>
    <text x="745" y="415" class="small-text">• Arrays</text>
    <text x="745" y="430" class="small-text">• Datos dinámicos</text>

    <!-- Flecha de referencia -->
    <path d="M 635 305 Q 650 305, 675 305" class="reference-arrow" marker-end="url(#arrow-ref)"/>
    <text x="650" y="295" text-anchor="middle" class="small-text" style="fill:#fb923c;">apunta a</text>
  </g>

  <!-- PASO 3: PROCESO DETALLADO -->
  <g id="proceso">
    <rect x="50" y="250" width="380" height="370" rx="8" class="box-dark" stroke="#27ae60" stroke-width="2"/>

    <circle cx="70" cy="265" r="18" fill="#16a34a" opacity="0.9"/>
    <text x="70" y="272" text-anchor="middle" class="step-text">3</text>

    <text x="100" y="275" class="subtitle">Pasos de la Instanciación</text>

    <!-- Paso A -->
    <circle cx="70" cy="310" r="15" fill="#dc2626"/>
    <text x="70" y="316" text-anchor="middle" class="step-text" style="font-size: 11px;">A</text>
    <text x="95" y="315" class="text" font-weight="bold">Se evalúa "new Persona(...)"</text>
    <text x="95" y="332" class="small-text">→ El operador new solicita memoria</text>

    <!-- Paso B -->
    <circle cx="70" cy="360" r="15" fill="#dc2626"/>
    <text x="70" y="366" text-anchor="middle" class="step-text" style="font-size: 11px;">B</text>
    <text x="95" y="365" class="text" font-weight="bold">Se reserva espacio en HEAP</text>
    <text x="95" y="382" class="small-text">→ Se crea el objeto en memoria dinámica</text>

    <!-- Paso C -->
    <circle cx="70" cy="410" r="15" fill="#dc2626"/>
    <text x="70" y="416" text-anchor="middle" class="step-text" style="font-size: 11px;">C</text>
    <text x="95" y="415" class="text" font-weight="bold">Se inicializan atributos</text>
    <text x="95" y="432" class="small-text">→ Valores por defecto (null, 0, false)</text>

    <!-- Paso D -->
    <circle cx="70" cy="460" r="15" fill="#dc2626"/>
    <text x="70" y="466" text-anchor="middle" class="step-text" style="font-size: 11px;">D</text>
    <text x="95" y="465" class="text" font-weight="bold">Se ejecuta el constructor</text>
    <text x="95" y="482" class="small-text">→ Se asignan valores específicos</text>

    <!-- Paso E -->
    <circle cx="70" cy="510" r="15" fill="#dc2626"/>
    <text x="70" y="516" text-anchor="middle" class="step-text" style="font-size: 11px;">E</text>
    <text x="95" y="515" class="text" font-weight="bold">Se obtiene la dirección</text>
    <text x="95" y="532" class="small-text">→ El operador new retorna @0x1A2B3C</text>

    <!-- Paso F -->
    <circle cx="70" cy="560" r="15" fill="#dc2626"/>
    <text x="70" y="566" text-anchor="middle" class="step-text" style="font-size: 11px;">F</text>
    <text x="95" y="565" class="text" font-weight="bold">Se asigna a la variable</text>
    <text x="95" y="582" class="small-text">→ p1 almacena la referencia en STACK</text>

    <!-- Nota final -->
    <rect x="60" y="595" width="350" height="15" fill="#713f12"/>
    <text x="235" y="606" text-anchor="middle" class="small-text" font-weight="bold">✓ p1 NO contiene el objeto,
      contiene su DIRECCIÓN
    </text>
  </g>

  <!-- Nota informativa final -->
  <text x="450" y="675" text-anchor="middle" class="small-text" font-style="italic">
    Diferencia clave: STACK almacena referencias, HEAP almacena objetos completos
  </text>
</svg>
